%!TEX root=../ast2016.tex

\section{Empirical Study}
\label{sec:empirical-study}

\subsection{Experimental Setup}

\input{tables/schemas.tex}

\begin{itemize}
  \item 32 schemas
    \begin{itemize}
      \item 1 to 42 tables
      \item 3 to 309 columns
      \item 0 to 134 constraints
      \item Includes each of the types of constraint supported by \SchemaAnalyst (\PK, \FK, \NOTNULL, \UNIQUE and \CHECK constraints)
    \end{itemize}
  \item 3 DBMSs -- \Postgres, \HyperSQL (in-memory), \SQLite (in-memory)
  \item 30 repeated trials
  \item 2 techniques -- \Original and \VirtualMutationAnalysis
  \item Metrics -- time taken for mutation analysis, number of mutants, number of test cases
  \item Mention that the mutation scores of the Original technique are used to validate the results given by virtual mutation analysis, and that in every case the results were identical. (Possibly repeat this in the threats section?)
\end{itemize}

% \paper{Mutation2013}{To perform the experiments, we used the Java programming language to implement our approach in the SchemaAnalyst tool [3]. SchemaAnalyst was compiled with the JDK 7 compiler and executed with the Oracle Java 1.7 64-bit virtual machine for Linux. We executed the experiments on a \_\_\_\_\_\_ machine, \_\_\_\_\_\_ 64-bit kernel, with a \_\_\_\_\_\_ GHz CPU and \_\_\_\_\_\_ RAM. The specific DBMS versions were Postgres \_\_\_\_\_\_ and SQLite \_\_\_\_\_\_, used in \_\_\_\_\_\_ configurations.}\todo{Add version number for HyperSQL. Mention that SQLite and HyperSQL were `in-memory'.}

\subsubsection{Research questions}

\textbf{RQ1: }\emph{How does the time taken by \vma compare to the Original technique, and how does
this vary depending on the DBMS in use?}\\

\textbf{RQ2: }\emph{Is the performance of Virtual mutation analysis dependant upon (a) the number of test cases being
executed, or (b) the number of mutants being analysed?}\\

\textbf{RQ3: }\emph{(RQ regarding number of mutants that can be analysed in the same time)}\\


\subsubsection{Methodology}
For RQs 1 and 2, we ran the \Original technique and \vma 30 times each, for each of the schemas with each of the DBMSs, collating the time taken. For each run, we used a test suite automatically generated using a search-based technique with a unique random seed. 

Details of the specific test suite generation algorithms used are detailed by McMinn \etal~\cite{McMinn2015}. We used the \AVM method as it is the most reliable automated technique for generating high levels of test coverage. The coverage criterion we used was a combination of ``ClauseAICC'', ``AUCC'' and ``ANCC'', which merges the strongest criteria for testing the integrity constraints of database schemas.

For RQ3, we then ran the \Original technique 30 times, but by performing mutation analysis by selecting mutants at random until each the time taken for the corresponding run of the 30 repetitions of \vma was exhausted.

We performed all experiments with our \SA tool \cite{Kapfhammer2013,Wright2014,McMinn2015},
compiled with the Java Development Kit 7 compiler and executed with the Linux version of the 64-bit Oracle Java 1.7 virtual machine. Experiments were executed on an Ubuntu 14.04 workstation, with a 3.13.0-44 GNU/Linux 64-bit kernel, a quad-core 2.4GHz CPU and 12GB RAM. All input (i.e., schemas) and output (i.e., data) files were stored on the local disk. We used the default configuration of \PostgreSQL version 9.3.5, \HyperSQL version 2.2.8 and \SQLite 3.8.2. \HyperSQL and \SQLite were used with ``in-memory'' mode enabled.


\subsection{Threats to Validity}

\subsection{Empirical Results}

% PURPOSE: Compare the virtual mutation technique to the original one in terms of their execution time, showing that
% virtual mutation is often significantly faster than the standard approach to mutation analysis.

\subsubsection{Comparing Original and Virtual Mutation}
\label{sec:empirical-study-RQ-original-virtual-time}
\input{sections/empirical-study-RQ-original-virtual-time}

% PURPOSE: Investigate the scalability of virtual mutation, looking at how the percentage of mean time saved varies as
% the number of mutants and the number of tests increases, revealing the best configurations for this method.

\subsubsection{Scalability of Virtual Mutation}
\label{sec:empirical-study-RQ-scalability-mutants-tests}
\input{sections/empirical-study-RQ-scalability-mutants-tests}

% PURPOSE: Compare the virtual and time-constrained techniques in terms of their mutation score and the number of
% mutants that are actually executed during mutation analysis, showing the superiority of virtual mutation.

\subsubsection{Virtual and Time-Constrained Mutation}
\label{sec:empirical-study-RQ-virtual-time-constrained-virtual}
\input{sections/empirical-study-RQ-time-constrained-virtual}

