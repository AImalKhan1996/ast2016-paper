%!TEX root=ast2016.tex

% \section{Empirical Study}
% \label{sec:empirical-study}

\section{Experimental Setup}
\label{sec:experimental-setup}

% TODO: Add in one introductory sentence to start off this section

\subsection{Relational Database Schemas}
\label{sec:subjects}

\input{tables/schemas.tex}

\begin{itemize}
  \item 32 schemas
    \begin{itemize}
      \item 1 to 42 tables
      \item 3 to 309 columns
      \item 0 to 134 constraints
      \item Includes each of the types of constraint supported by \SchemaAnalyst (\PK, \FK, \NOTNULL, \UNIQUE and \CHECK constraints)
    \end{itemize}
  \item 3 DBMSs -- \Postgres, \HyperSQL (in-memory), \SQLite (in-memory)
  \item 30 repeated trials
  \item 2 techniques -- \Original and \VirtualMutationAnalysis
  \item Metrics -- time taken for mutation analysis, number of mutants, number of test cases
  \item Mention that the mutation scores of the Original technique are used to validate the results given by virtual mutation analysis, and that in every case the results were identical. (Possibly repeat this in the threats section?)
\end{itemize}

\subsection{Research Questions}
\label{sec:research-questions}

The experiments in this paper investigate three research questions, which we state in the following fashion.

\vspace{5pt}

\textbf{RQ1 (Efficiency):} How does the time overhead of \VMA compare to the \Standard technique's cost, and how does
this vary depending on the DBMS in use?

\vspace{5pt}

\textbf{RQ2 (Scalability):} How does the time savings from using \VMA scale when increasing the number of analysed mutants
or the number of tests?

\vspace{5pt}

\textbf{RQ3 (Effectiveness):} How does the mutation score of \VMA compare to the score of a time-constrained method that
can only analyse mutants for the same amount of time as the presented approach?

\subsection{Methodology}
\label{sec:methodology}
For RQs 1 and 2, we ran the \Original technique and \vma 30 times each, for each of the schemas with each of the DBMSs, collating the time taken. For each run, we used a test suite automatically generated using a search-based technique with a unique random seed.

Details of the specific test suite generation algorithms used are detailed by McMinn \etal~\cite{McMinn2015}. We used the \AVM method as it is the most reliable automated technique for generating high levels of test coverage. The coverage criterion we used was a combination of ``ClauseAICC'', ``AUCC'' and ``ANCC'', which merges the strongest criteria for testing the integrity constraints of database schemas.

For RQ3, we then ran the \Original technique 30 times, but by performing mutation analysis by selecting mutants at random until each the time taken for the corresponding run of the 30 repetitions of \vma was exhausted.

We performed all experiments with our \SA tool \cite{Kapfhammer2013,Wright2014,McMinn2015},
compiled with the Java Development Kit 7 compiler and executed with the Linux version of the 64-bit Oracle Java 1.7 virtual machine. Experiments were executed on an Ubuntu 14.04 workstation, with a 3.13.0-44 GNU/Linux 64-bit kernel, a quad-core 2.4GHz CPU and 12GB RAM. All input (i.e., schemas) and output (i.e., data) files were stored on the local disk. We used the default configuration of \PostgreSQL version 9.3.5, \HyperSQL version 2.2.8 and \SQLite 3.8.2. \HyperSQL and \SQLite were used with ``in-memory'' mode enabled.

\subsection{Evaluation Metrics}
\label{sec:evaluation-metrics}

\subsection{Threats to Validity}
\label{sec:threats-to-validity}

% TODO: Explain that we check the mutation score to ensure that Standard and Virtual are the same!
% TODO: Reference the SSBSE 2015 paper that talk about transformation of the 

\section{Empirical Results}
\label{sec:empirical-results}

% PURPOSE: Compare the virtual mutation technique to the original one in terms of their execution time, showing that
% virtual mutation is often significantly faster than the standard approach to mutation analysis.

\subsection{Comparing Original and Virtual Mutation}
\label{sec:empirical-study-RQ-original-virtual-time}
\input{sections/empirical-study-RQ-original-virtual-time}

% PURPOSE: Investigate the scalability of virtual mutation, looking at how the percentage of mean time saved varies as
% the number of mutants and the number of tests increases, revealing the best configurations for this method.

\subsection{Scalability of Virtual Mutation}
\label{sec:empirical-study-RQ-scalability-mutants-tests}
\input{sections/empirical-study-RQ-scalability-mutants-tests}

% PURPOSE: Compare the virtual and time-constrained techniques in terms of their mutation score and the number of
% mutants that are actually executed during mutation analysis, showing the superiority of virtual mutation.

\subsection{Virtual and Time-Constrained Mutation}
\label{sec:empirical-study-RQ-virtual-time-constrained-virtual}
\input{sections/empirical-study-RQ-time-constrained-virtual}

